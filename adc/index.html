<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Análise de dados categorizados usando R</title>
  <meta name="description" content="Esse livro é uma tentativa de compilar todo o conteúdo da disciplina STA13833 - Análise de dados categorizados." />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Análise de dados categorizados usando R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Esse livro é uma tentativa de compilar todo o conteúdo da disciplina STA13833 - Análise de dados categorizados." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Análise de dados categorizados usando R" />
  
  <meta name="twitter:description" content="Esse livro é uma tentativa de compilar todo o conteúdo da disciplina STA13833 - Análise de dados categorizados." />
  

<meta name="author" content="Bruno Santos" />


<meta name="date" content="2020-03-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  

<link rel="next" href="tabelas-de-contingencia.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Análise de dados categorizados usando R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introdução</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#dados-categorizados-e-visualizacao"><i class="fa fa-check"></i><b>1.1</b> Dados categorizados e visualização</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#dados-sobre-musicas-do-raul-seixas-no-spotify"><i class="fa fa-check"></i><b>1.1.1</b> Dados sobre músicas do Raul Seixas no Spotify</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#dados-obtidos-do-datasus"><i class="fa fa-check"></i><b>1.1.2</b> Dados obtidos do DATASUS</a></li>
<li class="chapter" data-level="1.1.3" data-path="index.html"><a href="index.html#dados-sobre-o-campeonato-brasileiro-de-futebol-2012-2019"><i class="fa fa-check"></i><b>1.1.3</b> Dados sobre o Campeonato Brasileiro de Futebol 2012-2019</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#distribuicoes-de-probabilidade"><i class="fa fa-check"></i><b>1.2</b> Distribuições de probabilidade</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#distribuicao-binomial"><i class="fa fa-check"></i><b>1.2.1</b> Distribuição binomial</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#distribuicao-multinomial"><i class="fa fa-check"></i><b>1.2.2</b> Distribuição multinomial</a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#distribuicao-dirichlet"><i class="fa fa-check"></i><b>1.2.3</b> Distribuição Dirichlet</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#metodos-inferenciais"><i class="fa fa-check"></i><b>1.3</b> Métodos inferenciais</a><ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#metodo-da-maxima-verossimilhanca"><i class="fa fa-check"></i><b>1.3.1</b> Método da máxima verossimilhança</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#metodos-bayesianos"><i class="fa fa-check"></i><b>1.3.2</b> Métodos bayesianos</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#exercicios"><i class="fa fa-check"></i><b>1.4</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tabelas-de-contingencia.html"><a href="tabelas-de-contingencia.html"><i class="fa fa-check"></i><b>2</b> Tabelas de contingência</a><ul>
<li class="chapter" data-level="2.1" data-path="tabelas-de-contingencia.html"><a href="tabelas-de-contingencia.html#tipos-de-estudos"><i class="fa fa-check"></i><b>2.1</b> Tipos de estudos</a><ul>
<li class="chapter" data-level="2.1.1" data-path="tabelas-de-contingencia.html"><a href="tabelas-de-contingencia.html#estudo-descritivo"><i class="fa fa-check"></i><b>2.1.1</b> Estudo descritivo</a></li>
<li class="chapter" data-level="2.1.2" data-path="tabelas-de-contingencia.html"><a href="tabelas-de-contingencia.html#ensaio-clinico-aleatorizado"><i class="fa fa-check"></i><b>2.1.2</b> Ensaio clínico aleatorizado</a></li>
<li class="chapter" data-level="2.1.3" data-path="tabelas-de-contingencia.html"><a href="tabelas-de-contingencia.html#estudo-de-coorte"><i class="fa fa-check"></i><b>2.1.3</b> Estudo de coorte</a></li>
<li class="chapter" data-level="2.1.4" data-path="tabelas-de-contingencia.html"><a href="tabelas-de-contingencia.html#estudos-prospectivos-e-retrospectivos"><i class="fa fa-check"></i><b>2.1.4</b> Estudos prospectivos e retrospectivos</a></li>
<li class="chapter" data-level="2.1.5" data-path="tabelas-de-contingencia.html"><a href="tabelas-de-contingencia.html#estudos-tranversais-e-longitudinais"><i class="fa fa-check"></i><b>2.1.5</b> Estudos tranversais e longitudinais</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="tabelas-de-contingencia.html"><a href="tabelas-de-contingencia.html#probabilidade-conjunta-marginal-e-condicional"><i class="fa fa-check"></i><b>2.2</b> Probabilidade conjunta, marginal e condicional</a></li>
<li class="chapter" data-level="2.3" data-path="tabelas-de-contingencia.html"><a href="tabelas-de-contingencia.html#avaliacao-em-testes-diagnosticos"><i class="fa fa-check"></i><b>2.3</b> Avaliação em testes diagnósticos</a></li>
<li class="chapter" data-level="2.4" data-path="tabelas-de-contingencia.html"><a href="tabelas-de-contingencia.html#independencia"><i class="fa fa-check"></i><b>2.4</b> Independência</a></li>
<li class="chapter" data-level="2.5" data-path="tabelas-de-contingencia.html"><a href="tabelas-de-contingencia.html#amostragem-binomial-e-multinomial"><i class="fa fa-check"></i><b>2.5</b> Amostragem binomial e multinomial</a></li>
<li class="chapter" data-level="2.6" data-path="tabelas-de-contingencia.html"><a href="tabelas-de-contingencia.html#comparando-proporcoes-em-tabelas-2x2"><i class="fa fa-check"></i><b>2.6</b> Comparando proporções em tabelas 2x2</a></li>
<li class="chapter" data-level="2.7" data-path="tabelas-de-contingencia.html"><a href="tabelas-de-contingencia.html#razao-de-chances"><i class="fa fa-check"></i><b>2.7</b> Razão de chances</a></li>
<li class="chapter" data-level="2.8" data-path="tabelas-de-contingencia.html"><a href="tabelas-de-contingencia.html#testes-qui-quadrado-para-independencia"><i class="fa fa-check"></i><b>2.8</b> Testes qui-quadrado para independência</a></li>
<li class="chapter" data-level="2.9" data-path="tabelas-de-contingencia.html"><a href="tabelas-de-contingencia.html#testes-de-independencia-para-dados-ordinais"><i class="fa fa-check"></i><b>2.9</b> Testes de independência para dados ordinais</a></li>
<li class="chapter" data-level="2.10" data-path="tabelas-de-contingencia.html"><a href="tabelas-de-contingencia.html#testes-exatos-para-pequenas-amostras"><i class="fa fa-check"></i><b>2.10</b> Testes exatos para pequenas amostras</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="associacao-em-tabelas-de-tripla-entrada.html"><a href="associacao-em-tabelas-de-tripla-entrada.html"><i class="fa fa-check"></i><b>3</b> Associação em tabelas de tripla entrada</a><ul>
<li class="chapter" data-level="3.1" data-path="associacao-em-tabelas-de-tripla-entrada.html"><a href="associacao-em-tabelas-de-tripla-entrada.html#tabelas-parciais"><i class="fa fa-check"></i><b>3.1</b> Tabelas parciais</a></li>
<li class="chapter" data-level="3.2" data-path="associacao-em-tabelas-de-tripla-entrada.html"><a href="associacao-em-tabelas-de-tripla-entrada.html#associacoes-condicionais-vs-marginais"><i class="fa fa-check"></i><b>3.2</b> Associações condicionais vs marginais</a></li>
<li class="chapter" data-level="3.3" data-path="associacao-em-tabelas-de-tripla-entrada.html"><a href="associacao-em-tabelas-de-tripla-entrada.html#paradoxo-de-simpson"><i class="fa fa-check"></i><b>3.3</b> Paradoxo de Simpson</a></li>
<li class="chapter" data-level="3.4" data-path="associacao-em-tabelas-de-tripla-entrada.html"><a href="associacao-em-tabelas-de-tripla-entrada.html#razoes-de-chance-condicional-e-marginal"><i class="fa fa-check"></i><b>3.4</b> Razões de chance condicional e marginal</a></li>
<li class="chapter" data-level="3.5" data-path="associacao-em-tabelas-de-tripla-entrada.html"><a href="associacao-em-tabelas-de-tripla-entrada.html#independencia-condicional-vs-independencia-marginal"><i class="fa fa-check"></i><b>3.5</b> Independência condicional vs independência marginal</a></li>
<li class="chapter" data-level="3.6" data-path="associacao-em-tabelas-de-tripla-entrada.html"><a href="associacao-em-tabelas-de-tripla-entrada.html#associacao-homogenea"><i class="fa fa-check"></i><b>3.6</b> Associação homogênea</a></li>
<li class="chapter" data-level="3.7" data-path="associacao-em-tabelas-de-tripla-entrada.html"><a href="associacao-em-tabelas-de-tripla-entrada.html#exercicios-1"><i class="fa fa-check"></i><b>3.7</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Análise de dados categorizados usando R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">Análise de dados categorizados usando R</h1>
<p class="author"><em>Bruno Santos</em></p>
<p class="date"><em>2020-03-03</em></p>
</div>
<div id="introducao" class="section level1">
<h1><span class="header-section-number">Capítulo 1</span> Introdução</h1>
<p>A ciência <del>de dados</del> <strong>Estatística</strong> está interessada em discutir e aprender sobre a incerteza de variáveis aleatórias na nossa vida e as suas relações entre si. Em particular, essas variáveis aleatórias podem se apresentar como categorias. São exemplos: o gênero musical que uma pessoa prefere (blues, rock, samba, funk, …); a área de conhecimento que uma pessoa escolhe seguir carreira profissional (Exatas, Humanas, Biológicas); a informação sobre ser favorável a um projeto de governo (Sim, Não); entre diversos outros. A esse tipo de dados denominamos <em>dados categorizados</em> e sobre esse tipo variável aleatória que estamos interessados nessas notas de aula e referente curso.</p>
<p>Durante a apresentação desse material, estaremos interessados em discutir os modelos estatísticos que nos auxiliam a tomar decisões a respeito de hipóteses sobre esse tipo de dados. Também daremos ênfase aos códigos no software <code>R</code> para obtermos esses modelos estatísticos, assim como estaremos interessados nas melhores maneiras de visualizar os resultados.</p>
<p>Esse primeiro capítulo tem o intuito de contextualizar a análise de dados categorizados, apresentando exemplos desse tipo de dados, assim como podemos utilizar o <code>R</code> para visualizar esse tipo de dados. Além disso, também apresentamos as distribuições de probabilidade associadas a esse tipo de variável aleatória. Por fim, discutimos brevemente métodos de inferência para os parâmetros dessa distribuição, apresentando métodos de máxima verossimilhança e também métodos bayesianos.</p>
<div id="dados-categorizados-e-visualizacao" class="section level2">
<h2><span class="header-section-number">1.1</span> Dados categorizados e visualização</h2>
<p>Quando observamos dados como categorias, podemos classificar essas variáveis aleatórias como variáveis qualitativas. Essa denominação pode ainda ser dividida entre variáveis aleatórias qualitativas <strong>ordinais</strong> ou variáveis aleatórias qualitativas <strong>nominais</strong>. Para o primeiro tipo podemos dizer que existe uma ordem entre as diferentes categorias, enquanto que para a segunda não é possível fazer nenhum tipo de ordenamento que possa ser utilizado na análise dos dados. Por exemplo, faixas de renda (“Menor que 1 salário mín.”, “Entre 1 salário mín. e 2 salários mín.”, …) pode ser ordenada, logo diríamos que é uma variável qualitativa ordinal. Por outro lado, se considerarmos a variável tratamento em um experimento clínico, em que uma pessoa pode fazer do grupo controle ou do grupo tratamento, essas duas possibilidades (“Controle”, “Tratamento”) não permitem nenhuma ordem, logo essa variável aleatória seria denominada variável qualitativa nominal.</p>
<p>Na próxima subseção apresentaremos alguns exemplos de dados categóricos e como podemos visualizar a sua respectiva distribuição usando o software <code>R</code>.</p>
<div id="dados-sobre-musicas-do-raul-seixas-no-spotify" class="section level3">
<h3><span class="header-section-number">1.1.1</span> Dados sobre músicas do Raul Seixas no Spotify</h3>
<p>Como primeira ilustração, considere os dados que podem ser obtidos sobre a plataforma digital Spotify, a partir de API disponibilizada pelos responsáveis por essa rede social de <em>streaming</em> de músicas. A partir de uma obtenção de uma chave para acesso, é possível baixar diferentes variáveis de diferentes artistas, diferentes álbuns, as quais podem ser utilizadas para análise dos gostos musicais das pessoas, assim como dos diferentes estilos musicais e suas respectivas características, etc. Para essa ilustração consideremos dados do artista <strong>Raul Seixas</strong>, que é considerado por alguns como um dos precursores do rock no Brasil. Para obtenção de algumas informações pela API disponibilizada pelo Spotify, podemos obter os dados da seguinte maneira. Primeiramente, consideramos os seguintes pacotes, em que o primeiro nos permite o acesso às informações do Spotify de forma mais rápida, enquanto que o segundo nos permite organizar os dados no R de maneira mais ágil, e o terceiro nos possibilita o acesso dos dados da plataforma digital:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(Rspotify)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(httr)</a></code></pre></div>
<p>Em seguida, consideramos a variável <code>key</code> que deve ser obtida diretamente <a href="https://developer.spotify.com/documentation/general/guides/authorization-guide/">aqui</a>. Em posse dessa chave de acesso, podemos obter nossas informações de interesse:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># Obtendo a id de identificação do artista</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">raul_seixas_id &lt;-<span class="st"> </span><span class="kw">searchArtist</span>(<span class="st">&quot;Raul+Seixas&quot;</span>, <span class="dt">token =</span> key) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(id)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co"># Obtendo o id e o nome de todos os álbuns do artista disponíveis na plataforma</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">rs_albums &lt;-<span class="st"> </span><span class="kw">getAlbums</span>(raul_seixas_id<span class="op">$</span>id, <span class="dt">token =</span> key)</a>
<a class="sourceLine" id="cb2-8" data-line-number="8"></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co"># Obtendo para cada um dos álbuns obtidos anteriormente, o id e o nome de </span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co"># cada uma das músicas que compõem o álbum.</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11">rs_album_songs &lt;-<span class="st"> </span><span class="kw">lapply</span>(rs_albums<span class="op">$</span>id, getAlbum, <span class="dt">token =</span> key)</a>
<a class="sourceLine" id="cb2-12" data-line-number="12"></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co"># Obtendo algumas informações adicionais sobre o album.</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14">rs_album_songs_info &lt;-<span class="st"> </span><span class="kw">lapply</span>(rs_albums<span class="op">$</span>id, getAlbumInfo, <span class="dt">token =</span> key)</a></code></pre></div>
<p>Em seguida, precisamos obter todas as informações das músicas que queremos analisar. Isso é feita com ajuda das funções <code>lapply</code>, pois precisamos considerar os diferentes <code>id</code>’s dos álbuns e em seguida de cada uma das músicas. O seguinte código pode ser utilizado:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">lista_musicas_info &lt;-<span class="st"> </span><span class="kw">lapply</span>(rs_album_songs, <span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">  musicas_album_a &lt;-<span class="st"> </span><span class="kw">lapply</span>(a<span class="op">$</span>id, getFeatures, <span class="dt">token =</span> key)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">  num_variaveis &lt;-<span class="st"> </span><span class="kw">dim</span>(musicas_album_a[[<span class="dv">1</span>]])[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">  dados_musicas &lt;-<span class="st"> </span>musicas_album_a <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="st">    </span><span class="kw">unlist</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="st">    </span><span class="kw">matrix</span>(<span class="dt">ncol =</span> num_variaveis, <span class="dt">byrow =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="st">    </span><span class="kw">as.data.frame</span>() </a>
<a class="sourceLine" id="cb3-8" data-line-number="8">  <span class="kw">names</span>(dados_musicas) &lt;-<span class="st"> </span><span class="kw">names</span>(musicas_album_a[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">  dados_musicas <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="st">    </span><span class="kw">select</span>(danceability, energy, key, loudness, mode, speechiness, </a>
<a class="sourceLine" id="cb3-11" data-line-number="11">           acousticness, instrumentalness, liveness, valence, tempo,</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">           duration_ms, time_signature) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">nome =</span> a<span class="op">$</span>name)</a>
<a class="sourceLine" id="cb3-14" data-line-number="14">}) </a>
<a class="sourceLine" id="cb3-15" data-line-number="15"></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co"># Empilhando as músicas de todos os albuns em um mesmo banco de dados.</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17">todas_musicas &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind.data.frame, lista_musicas_info)</a>
<a class="sourceLine" id="cb3-18" data-line-number="18"></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="co"># Preenchendo os dados com nome do album</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20">todas_musicas<span class="op">$</span>nome_album &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(rs_album_songs), <span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb3-21" data-line-number="21">  <span class="kw">rep</span>(rs_albums<span class="op">$</span>name[a], <span class="kw">length</span>(rs_album_songs[[a]]<span class="op">$</span>id))</a>
<a class="sourceLine" id="cb3-22" data-line-number="22">}) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unlist</span>()</a>
<a class="sourceLine" id="cb3-23" data-line-number="23"></a>
<a class="sourceLine" id="cb3-24" data-line-number="24"></a>
<a class="sourceLine" id="cb3-25" data-line-number="25"><span class="co"># Obtendo data de lançamento</span></a>
<a class="sourceLine" id="cb3-26" data-line-number="26">todas_musicas<span class="op">$</span>data_lancamento &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(rs_album_songs), <span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb3-27" data-line-number="27">  <span class="kw">rep</span>(rs_album_songs_info[[a]]<span class="op">$</span>release_date[<span class="dv">1</span>], <span class="kw">length</span>(rs_album_songs[[a]]<span class="op">$</span>id))</a>
<a class="sourceLine" id="cb3-28" data-line-number="28">}) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unlist</span>()</a>
<a class="sourceLine" id="cb3-29" data-line-number="29"></a>
<a class="sourceLine" id="cb3-30" data-line-number="30"><span class="co"># Criando variável ano de lançamento a partir de variável de texto</span></a>
<a class="sourceLine" id="cb3-31" data-line-number="31">todas_musicas<span class="op">$</span>ano_lancamento &lt;-<span class="st"> </span><span class="kw">substr</span>(todas_musicas<span class="op">$</span>data_lancamento, <span class="dv">1</span>, <span class="dv">4</span>)</a></code></pre></div>
<p>Para esse exemplo consideramos somente as músicas que apresentam ano de lançamento menor do que 1990, segundo informações obtidas na própria plataforma.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">musicas_raul_seixas &lt;-<span class="st"> </span><span class="kw">filter</span>(todas_musicas, ano_lancamento <span class="op">&lt;</span><span class="st"> &quot;1990&quot;</span>)</a></code></pre></div>
<p>Agora podemos finalmente visualizar algumas das informações obtidas. Para essa parte, consideramos os seguintes pacotes.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw">library</span>(ggridges)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="kw">library</span>(rgdal)</a></code></pre></div>
<p>Por exemplo, poderíamos estar interessados no tempo de duração das músicas ao longo dos anos. Primeiramente, consideramos a variável tempo de duração em sua forma quantitativa. O seguinte gráfico com a densidade estimada do tempo de duração das músicas para os diferentes anos de lançamento poderia ser obtido com o seguinte código</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">musicas_raul_seixas <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">duration =</span> <span class="kw">as.numeric</span>(<span class="kw">as.character</span>(duration_ms))<span class="op">/</span><span class="dv">1000</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ano_lancamento, <span class="dt">x =</span> duration, <span class="dt">fill =</span> <span class="kw">stat</span>(x))) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_density_ridges_gradient</span>(<span class="dt">scale =</span> <span class="dv">2</span>, <span class="dt">rel_min_height =</span> <span class="fl">0.01</span>, </a>
<a class="sourceLine" id="cb6-5" data-line-number="5">                               <span class="dt">gradient_lwd =</span> <span class="fl">1.</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="st">  </span><span class="kw">labs</span>(</a>
<a class="sourceLine" id="cb6-7" data-line-number="7">    <span class="dt">x =</span> <span class="st">&quot;Duração em s&quot;</span>,</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">    <span class="dt">y =</span> <span class="st">&quot;Ano do lançamento&quot;</span>,</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">    <span class="dt">title =</span> <span class="st">&quot;Distribuição da duração das músicas do Raul Seixas&quot;</span>,</a>
<a class="sourceLine" id="cb6-10" data-line-number="10">    <span class="dt">subtitle =</span> <span class="st">&quot;Análise em função do ano de lançamento&quot;</span>,</a>
<a class="sourceLine" id="cb6-11" data-line-number="11">    <span class="dt">caption =</span> <span class="st">&quot;Fonte: Spotify&quot;</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="st">  </span><span class="kw">scale_fill_viridis_c</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&#39;none&#39;</span>) </a></code></pre></div>
<p><img src="notas_livro_files/figure-html/graf1-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Nota-se que não é possível obter nenhuma indicação clara de relação entre a distribuição do tempo e o ano do lançamento. Poderíamos categorizar o tempo de duração para simplificar essa análise. Nesse caso talvez fosse interessante considerar uma categorização das músicas considerando somente 3 possibilidades: duração curta, média ou longa. Essa categorização poderia ser feita inclusive utilizando os quantis da própria variável utilizando a função <code>quantcut</code> do pacote <code>gtools</code>. O resultado dessa categorização pode ser vista na figura a seguir.</p>
<p><img src="notas_livro_files/figure-html/graf2-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Ao longo do texto estaremos interessados em discutir por exemplo que tipo de associação existe entre essas duas variáveis categóricas. Por exemplo, poderíamos dizer que as duas variáveis são independentes? Esse tema será discutido nos próximos capítulos.</p>
<p>Outra variável categórica disponível na APi do Spotify seria o tom geral da música, que é descrito da seguinte forma, conforme <a href="https://developer.spotify.com/documentation/web-api/reference/tracks/get-audio-analysis/">manual de referência</a>, e traduzido livremente aqui:</p>
<blockquote>
<p>O tom geral estimado da música. Os valores nesse campo variam de 0 a 11, mapeando para os tons de acordo com uma notação clássica de tom (e.g., 0 = Dó, 1 = Dó#, …). Se nenhum tom é detectado, o valor é igual a -1.</p>
</blockquote>
<p><img src="notas_livro_files/figure-html/graf3-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Na Figura <a href="#fig:graf3"><strong>??</strong></a> podemos ver a distribuição do uso de diferentes tons ao longo dos anos pelo artista Raul Seixas. Lembrando que esses tons são estimados, inclusive a plataforma disponibiliza uma outra variável que associa a cada um desses tons estimados um grau de confiança, porém essa informação não é utilizada aqui. Porém, a partir dessa análise inicial poderíamos dizer que para alguns anos o número de diferentes tons nessa música é menos expressivo. Enquanto que para outros anos a utilização de muitos tons é mais acentuada. Poderíamos apontar o ano de 1977 como um ano em que houve o maior número de tons diferentes na música.</p>
<p>Outra análise que poderia ser feita seria avaliar a relação entre o tempo da música, considerando essa variável categorizada, e o tom utilizado. Para isso, em uma análise descritiva poderíamos considerar o gŕafico a seguir.</p>
<p><img src="notas_livro_files/figure-html/graf4-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Porém a visualização dos resultados nesse caso, parece ser um pouco prejudicada, devido ao número muito maior de tons do que de categorias de duração da música. Por esse motivo, uma outra possibilidade é alterar o modo de visualização. Poderíamos observar a distribuição da duração da música em função dos tons da música, conforme figura a seguir.</p>
<p><img src="notas_livro_files/figure-html/graf5-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Note que a visualização da informação na Figura <a href="#fig:graf5"><strong>??</strong></a> parece ser um pouco mais simplificada do que na Figura <a href="#fig:graf4"><strong>??</strong></a>. Porém a análise da última figura mostra que para alguns tons de música não foi possível observar músicas das três diferentes durações. Por exemplo, para o tom <strong>Ré#</strong> somente músicas de duração média foram observadas. Esse tipo de observação é importante para discutirmos modelos estatísticos que poderiam ser supostos para os dados. Eventualmente categorias sem observações de valores podem se tornar problemáticas para determinadas análises.</p>
<p>O objetivo dessa subseção era apresentar uma forma de diferente de obtenção de dados para análise, nesse caso, considerando informações obtidas de uma plataforma de <em>streaming</em> de músicas, como Spotify. Também é importante discutir como visualizar a informação obtida. Como exercício, que será reforçado ao final do capítulo, seria interessante a tentativa de reprodução dos gráficos apresentados aqui.</p>
</div>
<div id="dados-obtidos-do-datasus" class="section level3">
<h3><span class="header-section-number">1.1.2</span> Dados obtidos do DATASUS</h3>
<p>Para um segundo exemplo sobre dados categorizados vamos utilizar informações sobre o <a href="http://datasus.saude.gov.br/">DATASUS</a>, em que diversas variáveis sobre o sistema hospitalar estão disponíveis para uso de todos. Para essa ilustração, consideremos o Sistema de Informações Hospitalares (SIH), em que podemos verificar em todos os Estados brasileiros quantas pessoas foram hospitalizadas em hospitais, em função do tempo de hospitalização. Tal informação pode ser importante para eventualmente considerar problemas de eficiência em determinadas regiões ou eventualmente de profissionais que podem estar prejudicando o atendimento à população. Outras hipóteses que devem ser consideradas para analisar o tempo de hospitalização podem estar relacionadas ao clima ou poluição das cidades, assim como aos/às possíveis motivos/doenças que causam essas hospitalizações, entre outros fatores. Porém, aqui inicialmente vamos utilizar somente os dados de em sua forma mais simples, isto é, vamos avaliar por Estado a duração do tempo de hospitalização para o ano de 2018.</p>
<p>Separemos inicialmente o tempo de hospitalização até 3 dias, entre 3 dias e até 7 dias e mais do que 7 dias. A depender do interesse, outras categorizações poderiam ser utilizadas para o efeito dessa análise. A tabela com as respectivas quantidades é apresentada em seguida:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">Menor que 3 dias</th>
<th align="right">Entre 3 e 7 dias</th>
<th align="right">Maior que 7 dias</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>AC</td>
<td align="right">29.324</td>
<td align="right">8.757</td>
<td align="right">6.714</td>
</tr>
<tr class="even">
<td>AL</td>
<td align="right">116.464</td>
<td align="right">31.494</td>
<td align="right">29.557</td>
</tr>
<tr class="odd">
<td>AM</td>
<td align="right">108.132</td>
<td align="right">44.931</td>
<td align="right">31.727</td>
</tr>
<tr class="even">
<td>AP</td>
<td align="right">23.960</td>
<td align="right">7.720</td>
<td align="right">6.332</td>
</tr>
<tr class="odd">
<td>BA</td>
<td align="right">567.871</td>
<td align="right">135.945</td>
<td align="right">125.358</td>
</tr>
<tr class="even">
<td>CE</td>
<td align="right">302.072</td>
<td align="right">103.923</td>
<td align="right">98.765</td>
</tr>
<tr class="odd">
<td>DF</td>
<td align="right">118.476</td>
<td align="right">47.189</td>
<td align="right">46.562</td>
</tr>
<tr class="even">
<td>ES</td>
<td align="right">147.631</td>
<td align="right">52.018</td>
<td align="right">43.391</td>
</tr>
<tr class="odd">
<td>GO</td>
<td align="right">226.784</td>
<td align="right">57.489</td>
<td align="right">49.280</td>
</tr>
<tr class="even">
<td>MA</td>
<td align="right">344.637</td>
<td align="right">69.411</td>
<td align="right">57.330</td>
</tr>
<tr class="odd">
<td>MG</td>
<td align="right">745.551</td>
<td align="right">274.402</td>
<td align="right">225.807</td>
</tr>
<tr class="even">
<td>MS</td>
<td align="right">110.933</td>
<td align="right">31.866</td>
<td align="right">26.057</td>
</tr>
<tr class="odd">
<td>MT</td>
<td align="right">127.860</td>
<td align="right">35.091</td>
<td align="right">28.691</td>
</tr>
<tr class="even">
<td>PA</td>
<td align="right">345.591</td>
<td align="right">94.365</td>
<td align="right">53.964</td>
</tr>
<tr class="odd">
<td>PB</td>
<td align="right">111.170</td>
<td align="right">38.405</td>
<td align="right">37.718</td>
</tr>
<tr class="even">
<td>PE</td>
<td align="right">329.240</td>
<td align="right">118.111</td>
<td align="right">117.593</td>
</tr>
<tr class="odd">
<td>PI</td>
<td align="right">141.089</td>
<td align="right">42.908</td>
<td align="right">34.343</td>
</tr>
<tr class="even">
<td>PR</td>
<td align="right">607.942</td>
<td align="right">160.164</td>
<td align="right">118.811</td>
</tr>
<tr class="odd">
<td>RJ</td>
<td align="right">390.143</td>
<td align="right">147.568</td>
<td align="right">190.146</td>
</tr>
<tr class="even">
<td>RN</td>
<td align="right">109.622</td>
<td align="right">30.802</td>
<td align="right">34.490</td>
</tr>
<tr class="odd">
<td>RO</td>
<td align="right">81.671</td>
<td align="right">21.138</td>
<td align="right">17.069</td>
</tr>
<tr class="even">
<td>RR</td>
<td align="right">26.237</td>
<td align="right">9.323</td>
<td align="right">8.185</td>
</tr>
<tr class="odd">
<td>RS</td>
<td align="right">399.140</td>
<td align="right">166.227</td>
<td align="right">180.125</td>
</tr>
<tr class="even">
<td>SC</td>
<td align="right">317.700</td>
<td align="right">94.846</td>
<td align="right">78.365</td>
</tr>
<tr class="odd">
<td>SE</td>
<td align="right">60.864</td>
<td align="right">16.049</td>
<td align="right">17.864</td>
</tr>
<tr class="even">
<td>SP</td>
<td align="right">1.581.736</td>
<td align="right">474.649</td>
<td align="right">481.952</td>
</tr>
<tr class="odd">
<td>TO</td>
<td align="right">42.658</td>
<td align="right">12.933</td>
<td align="right">12.420</td>
</tr>
</tbody>
</table>
<p>Porém, note como essa tabela contêm muitas linhas, a informação que gostaríamos de avaliar fica um pouco prejudicada em virtude dessa quantidade grande de <em>inputs</em>. Uma outra maneira de visualizar essa quantidade seria colocar isso num gráfico. Em se tratando de uma variável que se refere a uma informação espacial podemos utilizar um mapa para apresentar esses dados. Além disso, se temos interesse em discutir as categorias de tempo de internação, podemos calcular a proporção de pessoas em cada uma das categorias condicionalmente ao Estado, isto é, para cada Estado verificamos qual é a proporção de pessoas que ficaram internadas até 3 dias, a proporção que ficou internada entre 3 e 7 dias e, por último, a proporção que ficou internada um tempo maior que 7 dias.</p>
<p>Se fizermos isso, o resultado no gráfico com os mapas ficariam da seguinte forma</p>
<p><img src="notas_livro_files/figure-html/graf6-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Porém, note agora que devido a diferença de escala entre as três categorias, não é possível perceber a diferença entre os três mapas. No entanto, não é necessário observar essas três proporções, porque elas são complementares, isto é, a soma das três é igual a 1. Nesse caso, podemos focar nas duas categorias à direita que têm escalas muito mais próximas.</p>
<p><img src="notas_livro_files/figure-html/graf7-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Com isso obtemos a Figura <a href="#fig:graf7"><strong>??</strong></a> em que é possível identificar de forma muito mais evidente a diferença entre as proporções de internação entre os diferentes Estados. Por exemplo, agora é possível notar de forma bastante clara com o Rio de Janeiro tem um percentual de internação, condicional ao tempo de internação maior que 7 dias, muito maior que os outros Estados. Seria interessante discutir ou entender os motivos por trás dessa diferença. Seria a distribuição das doenças pelas quais as pessoas são levadas ao hospital diferente nesse Estado do que em outros? Seria um problema típico do ano de 2018, em que houve algum surto de alguma doença? Ao longo do texto, iremos utilizar mais informações para discutir essas hipóteses.</p>
</div>
<div id="dados-sobre-o-campeonato-brasileiro-de-futebol-2012-2019" class="section level3">
<h3><span class="header-section-number">1.1.3</span> Dados sobre o Campeonato Brasileiro de Futebol 2012-2019</h3>
<p>Como última representação de dados categorizados poderíamos considerar dados de esportes também. Em diversos esportes é interessante analisar a distribuição dos resultados e tentar buscar informações que ajudem a entender a aleatoriedade dos respectivos esportes. Isso não é diferente no futebol e podemos pensar, por exemplo, na diferença entre jogar “em casa” ou “fora de casa”, como é comum identificar os times que são mandantes e aqueles que viajam para jogar no campo do adversário.</p>
<p>Para isso, consideremos para essa análise do Campeonato Brasileiro entre os anos de 2012-2019, os quais podemos obter os dados do sítio <a href="https://www.football-data.co.uk/brazil.php">football-data.co.uk</a>, em que as descrições dos campos do banco de dados podem ser encontradas <a href="http://www.football-data.co.uk/notes.txt">aqui</a>.</p>
<p>Inicialmente, podemos identificar o resultado da partida como uma variável aleatória categórica, em que podemos classificar os seus possíveis valores como: “C”, vitória do time da casa; “E”, empate; “F”, vitória do time visitante. Se observarmos a distribuição dessas variáveis ao longo dos anos, veremos o resultado na figura a seguir.</p>
<p><img src="notas_livro_files/figure-html/graf8-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>É possível perceber, por exemplo, que a distribuição tem poucas alterações ao longo dos anos. Em particular, a proporção de vezes que o time visitante vence costuma variar em torno de 25%. O mesmo valor parece ser verdade para a proporção de empates. Valores mais diferentes dessa <em>regra</em> parecem ter sido os três últimos anos, de 2017 a 2019. Esse tipo de análise, por exemplo, é intuito desse curso. Por exemplo, será que poderíamos responder que essas probabilidades de vitória de cada um dos casos seria independente do ano do Campeonato Brasileiro? Em outras palavras, temos o interesse em dizer se essas probabilidades se manteram as mesmas ao longo dos anos, ponderando a incerteza natural desses processos.</p>
<p>Uma outra análise simples que poderia ser feita seria a comparação do desempenho dos campeões com os demais participantes em cada um dos anos. Por exemplo, será que a distribuição dos resultados do campeão ao longo dos anos teve uma grande variação para esses certames analisados? Se fizermos isso, o resultado seria o seguinte:</p>
<p><img src="notas_livro_files/figure-html/graf9-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>A Figura acima pode ser um pouco problemática, porque a partir da sua análise não é possível identificar se o time campeão se saiu vencedor em cada uma das partidas que fez como mandante ou visitante. Porém, é possível perceber alguns padrões. Por exemplo, em geral, a proporção de empates parece ser menor para os times que acabam se sagrando campeões. Por outro lado, também parece haver uma proporção maior de vitórias do time jogando fora de casa. Aqui, é claro devemos ter o cuidado de notar que essas vitórias também podem ter sido do time adversário, quando jogou contra o time campeão na <em>casa</em> deste.</p>
<p>Aqui poderíamos pensar em modelos probabilísticos que pudessem a explicar a probabilidade de vitória entre os times em cada um dos jogos. Ao longo do texto, iremos retornar a esse banco de dados para discutir como trabalhar esse tipo de informações.</p>
</div>
</div>
<div id="distribuicoes-de-probabilidade" class="section level2">
<h2><span class="header-section-number">1.2</span> Distribuições de probabilidade</h2>
<p>Para discutir sobre a aleatoriedade das variáveis categóricas de interesse nos problemas apresentados ao longo desse texto, é preciso fazer suposições sobre a distribuição de probabilidade dessas variáveis aleatórias de interesse. Ao menos, essa é uma das perspectivas possíveis, e talvez mais utilizadas, dentro da Estatística, a qual denominamos de <strong>Estatística Paramétrica</strong>. Esse nome se dá devido aos parâmetros das distribuições de probabilidade, que iremos utilizar em cada um dos problemas. Para o caso de dados categorizados, iremos considerar as seguintes distribuições de probabilidade: <em>binomial</em>, <em>multinomial</em> e <em>Dirichlet</em>. As duas primeiras iremos assumir para a função de distribuição dos valores observados, que iremos identificar como verossimilhança posteriormente, enquanto que a última distribuição de probabilidade iremos utilizar para definir uma distribuição de probabilidade <em>a priori</em> quando estivermos falando sobre o método de inferência bayesiano na última seção deste capítulo.</p>
<div id="distribuicao-binomial" class="section level3">
<h3><span class="header-section-number">1.2.1</span> Distribuição binomial</h3>
<p>Primeiramos, definamos uma variável aleatória <span class="math inline">\(Y\)</span>, em que somente dois resultados são possíveis. Por exemplo, ao jogarmos uma moeda o resultado pode ser somente <em>cara</em> ou <em>coroa</em>. Ainda quando vamos classificar as pessoas com relação ao seu hábito de fumar, diríamos que os resultados possíveis são <em>fumante</em> ou <em>não fumante</em>. A esses valores usualmente associamos a denominação de sucesso ou fracasso, porém essa denominação não é importante aqui. Podemos associar a esses possíveis valores, os valores numéricos 0 e 1, apenas para facilitar a definição de alguns eventos de probabilidade. Para o caso do hábito de fumar, poderíamos fazer</p>
<p><span class="math display">\[
Y = \begin{cases}
1, &amp; \mbox{se a pessoa é fumante}, \\
0, &amp; \mbox{caso contrário}
    \end{cases}
\]</span>
Para essa variável binária podemos assumir que esta tem distribuição <em>Bernoulli</em>, com uma parâmetro de probabilidade <strong>p</strong> que define essa distribuição de probabilidade. Ao definir esse parâmetro, podemos dizer que
<span class="math display">\[
P(Y = 1) = p, \quad \quad P(Y = 0) = 1 - p.
\]</span>
Agora considere uma sequência de variáveis aleatórias indepedentes e identicamente distribuídas com distribuição Bernoulli, i.e., <span class="math inline">\(Y_1, \cdots, Y_n\)</span>, em que <span class="math inline">\(Y_i \sim Bernoulli(p)\)</span>, <span class="math inline">\(i = 1, \cdots, n\)</span>. Se definirmos <span class="math inline">\(W\)</span> como a soma dessa sequência, i.e., <span class="math inline">\(W = \sum_{i=1}^n Y_i\)</span>, então dizemos que <span class="math inline">\(W\)</span> tem distribuição Binomial com parâmetros <span class="math inline">\(n\)</span> e <span class="math inline">\(p\)</span>. Os valores possíveis que essa variável aleatória assume são <span class="math inline">\(W = \{0, 1, \cdots, n\}\)</span> e a sua função de probabilidade é dada por</p>
<p><span class="math display">\[
P(W = w) = \frac{n!}{w!(n-w)!} p^w (1-p)^{n-w}, \quad w = 0, 1, \cdots, n.
\]</span>
Para alguns valores fixados de <span class="math inline">\(n\)</span> e <span class="math inline">\(p\)</span> podemos utilizar o <code>R</code> para fazer o gráficos das respectivas funções de probabilidade. Por exemplo, se fizermos <span class="math inline">\(n = 10\)</span> e <span class="math inline">\(p\)</span> variando entre 0,2, 0,5 e 0,8, encontraríamos o seguinte:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">valores_p &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">n &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"></a>
<a class="sourceLine" id="cb7-4" data-line-number="4">valores_fp &lt;-<span class="st"> </span><span class="kw">sapply</span>(valores_p, <span class="cf">function</span>(x) <span class="kw">dbinom</span>(<span class="dv">0</span><span class="op">:</span>n, <span class="dt">prob =</span> x, <span class="dt">size =</span> n)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="st">  </span><span class="kw">as.numeric</span>()</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"></a>
<a class="sourceLine" id="cb7-7" data-line-number="7">dados_figura &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span>n, <span class="kw">length</span>(valores_p)),</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">                           <span class="dt">n =</span> <span class="kw">rep</span>(n, <span class="kw">length</span>(valores_fp)), </a>
<a class="sourceLine" id="cb7-9" data-line-number="9">                           <span class="dt">p =</span> <span class="kw">rep</span>(valores_p, <span class="dt">each =</span> n <span class="op">+</span><span class="st"> </span><span class="dv">1</span>), </a>
<a class="sourceLine" id="cb7-10" data-line-number="10">                           <span class="dt">valores_prob =</span> valores_fp)</a>
<a class="sourceLine" id="cb7-11" data-line-number="11"></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="kw">ggplot</span>(dados_figura) <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> valores_prob, <span class="dt">fill =</span> <span class="kw">factor</span>(p)), </a>
<a class="sourceLine" id="cb7-14" data-line-number="14">           <span class="dt">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="dt">width =</span> <span class="fl">0.5</span>, <span class="dt">position =</span> <span class="st">&#39;dodge&#39;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="st">  </span><span class="kw">scale_fill_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;p = &quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>p) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span>n) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Distribuição Binomial para n = 10&quot;</span>, </a>
<a class="sourceLine" id="cb7-19" data-line-number="19">       <span class="dt">subtitle =</span> <span class="st">&quot;E p igual a 0,2, 0,5 ou 0,8&quot;</span>,</a>
<a class="sourceLine" id="cb7-20" data-line-number="20">       <span class="dt">y =</span> <span class="st">&quot;P(W = w)&quot;</span>,</a>
<a class="sourceLine" id="cb7-21" data-line-number="21">       <span class="dt">x =</span> <span class="st">&quot;w&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-22" data-line-number="22"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&#39;bottom&#39;</span>, </a>
<a class="sourceLine" id="cb7-23" data-line-number="23">        <span class="dt">strip.background =</span> <span class="kw">element_blank</span>(), </a>
<a class="sourceLine" id="cb7-24" data-line-number="24">        <span class="dt">strip.text.x =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="notas_livro_files/figure-html/graf10-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Note como para <span class="math inline">\(p\)</span> igual a 0,5 os valores das probabilidades parecem ser simétricos em torno do valor quando <span class="math inline">\(w = 5\)</span>. Enquanto que para os outros dois valores de <span class="math inline">\(p\)</span> a distribuição de probabilidade parece assimétrica. Esse é um resultado característico da distribuição Binomial. Como propriedades dessa variável aleatória <span class="math inline">\(W\)</span> temos que
<span class="math display">\[
E(W) = np, \quad Var(W) = np(1-p).
\]</span>
Essas informações nos ajudam então a propôr essa distribuição de probabilidade para determinadas variáveis aleatórias. Por exemplo, se considerássemos o exemplo da seção anterior, sobre tempo de internação, mas fizemos a seguinte categorização
<span class="math display">\[
Y = \begin{cases}
1, &amp; \mbox{se a pessoa fica internada até 3 dias}, \\
0, &amp; \mbox{caso contrário}.
    \end{cases}
\]</span>
Considerando uma amostra de 10 pessoas, ou seja <span class="math inline">\(n = 10\)</span>, poderíamos dizer qual a probabilidade de 5 dessas pessoas terem ficado internada por até 3 dias. Para <span class="math inline">\(p = 0,5\)</span> essa probabilidade seria igual a
<span class="math display">\[
P(W = 5) = {10 \choose 5} 0.5^5 (1-0.5)^{10 - 5} = 0,2461
\]</span>
Se considerássemos <span class="math inline">\(p=0.8\)</span>, ao invés de <span class="math inline">\(p = 0.5\)</span>, obteríamos que essa probabilidade é igual a 0,0264. Com relação aos valores esperados, teríamos que esses valores seriam 5 e 8, respectivamente considerando os dois valores para <span class="math inline">\(p\)</span>. Vemos então que ao assumir valores para os parâmetros somos capazes de fazer asserções sobre a incerteza dessas variáveis aleatórias. Na prática os valores desses parâmetros são sempre desconhecidos, então precisaremos discutir como fazer inferência sobre esses valores. O tema da próxima seção é exatamente este.</p>
<p>Ainda sobre a distribuição Binomial, um resultado importante que podemos citar se refere a aproximação dessa distribuição de probabilidade pela distribuição Normal, quando <span class="math inline">\(n \rightarrow \infty\)</span>, isto é, quando <span class="math inline">\(n\)</span> cresce. Considere o gráfico anterior, por exemplo, quando consideramos <span class="math inline">\(n = 100\)</span>, desconsiderando o valor de <span class="math inline">\(p = 0,5\)</span>.</p>
<p><img src="notas_livro_files/figure-html/graf11-1.png" width="80%" style="display: block; margin: auto;" />
Notem como apesar de <span class="math inline">\(p\)</span> ser um valor diferente de 0,5, agora a distribuição dos valores de probabilidade parece ter uma distribuição de probabilidade simétrica. Inclusive os valores parecem se distribuir de acordo com a distribuição Normal. Aliás, essa aproximação pode ser utilizada para calcular probabilidades de uma variável aleatória Binomial, que é uma distribuição de probabilidade para valores discretos, com a distribuição Normal, que é uma distribuição de probabilidade para valores contínuos. Essa aproximação se dá utilizando uma distribuição Normal com média <span class="math inline">\(\mu = np\)</span> e desvio padrão <span class="math inline">\(\sigma = \sqrt{np(1-p)}\)</span>, e pode ser justificada pelo Teorema do Limite Central, porém não faremos essa demonstração aqui.</p>
</div>
<div id="distribuicao-multinomial" class="section level3">
<h3><span class="header-section-number">1.2.2</span> Distribuição multinomial</h3>
<p>Considere agora novamente o exemplo do tempo de internação, segundo dados do SUS, que utilizamos na seção anterior. Quando discutimos uma ilustração da distribuição Binomial, na subseção anterior, consideremos uma categorização somente com duas categorias. Isso foi devido a necessidade de definirmos a distribuição Binomial como uma soma de variáveis aleatórias Bernoulli, em que somente dois valores são possíveis. Considere o caso em que temos mais de duas categorias como resultados possíveis de um experimento aleatório discreto, e temos uma sequência independente desses eventos aleatórios. Supondo que gostaríamos de falar sobre as probabilidades dos possíveis valores observados para cada uma das categorias, então precisamos utilizar a distribuição <strong>multinomial</strong>.</p>
<p>A variável aleatória associada à distribuição multinomial é uma variável aleatória multivariada. Por exemplo, para falarmos de probabilidade para valores dessa variável aleatória temos que definir um vetor de possilidades. Por exemplo, voltando ao exemplo do tempo de internação, supondo uma amostra de 10 pessoas, um possível valor para essa variável aleatória seria <span class="math inline">\(\{4, 5, 1\}\)</span>, em que 4 pessoas ficaram internadas até 3 dias; 5 pessoas ficaram internadas entre 3 e 7 dias; e 1 pessoa ficou internada por mais de 7 dias.</p>
<p>A distribuição multinomial é uma generalização da distribuição Binomial. Considere que temos <span class="math inline">\(k\)</span> categorias. Podemos definir as probabilidades de cada uma das categorias pelo vetor <span class="math inline">\(\{p_1, p_2, \cdots, p_k\}\)</span>, em que <span class="math inline">\(\sum_{i=1}^k p_i = 1\)</span>. Para definir sua função de probabilidade, considere os valores <span class="math inline">\(n_1, n_2, \cdots, n_k\)</span>, em que <span class="math inline">\(n_i\)</span> representa a quantidade de observações, dentre os <span class="math inline">\(n\)</span> ensaios independentes, que são classificados na <span class="math inline">\(i\)</span>-ésima categoria, em que <span class="math inline">\(\sum_{i=1}^k n_i = n\)</span>. Assim, podemos definir a função de probabilidade como</p>
<p><span class="math display">\[
P(Y_1 = y_1, Y_2 = y_2, \cdots, Y_k = y_k) = 
\frac{n!}{y_1!y_2!\cdots y_k!} p_1^{y_1} p_2^{y_2} \cdots p_k^{y_k}
\]</span>
Consideremos o caso em que <span class="math inline">\(k = 3\)</span>, então podemos visualizar o gráfico com essa função de probabilidade de forma mais simples. Considere o caso em que <span class="math inline">\(n = 10\)</span>, então supondo o vetor de probabilidades <span class="math inline">\((p_1, p_2, p_3) = (0,4, 0,4, 0,2)\)</span> teríamos o seguinte gráfico da distribuição de probabilidade</p>
<p><img src="notas_livro_files/figure-html/graf12-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Note, por exemplo, que algumas combinações não são possíveis. Por exemplo, para <span class="math inline">\(y_1 = 6\)</span> e <span class="math inline">\(y_2 = 5\)</span> não é possível calcular nenhum valor de probabilidade, pois isso violaria a condição que <span class="math inline">\(\sum_{i=1}^k n_i = n\)</span>. Se considerássemos outro valor para o vetor de probabilidades, como <span class="math inline">\((p_1, p_2, p_3) = (0,10, 0,25, 0,65)\)</span> obteríamos o seguinte</p>
<p><img src="notas_livro_files/figure-html/graf13-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Essa ilustração é somente para ilustrar como devemos calcular as probabilidades para o caso multivariado e como devemos entender essa distribuição de probabilidade. De todo modo, iremos utilizar a distribuição multinomial em diversos momentos nos próximos capítulos.</p>
</div>
<div id="distribuicao-dirichlet" class="section level3">
<h3><span class="header-section-number">1.2.3</span> Distribuição Dirichlet</h3>
<p>A distribuição Dirichlet é uma versão multivariada da distribuição Beta. Lembremos que a distribuição de probabilidade Beta é uma distribuição voltada para variáveis aleatórias contínuas com suporte no intervalo [0, 1]. Supondo uma variável aleatória, <span class="math inline">\(Y \in [0, 1]\)</span>, dizemos que <span class="math inline">\(Y\)</span> segue uma distribuição beta com parâmetros <span class="math inline">\(a &gt; 0\)</span> e <span class="math inline">\(b &gt; 0\)</span>, se sua função de densidade for escrita como
<span class="math display">\[
f(y | a, b) = \frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)} y^{a-1}(1-y)^{b-1}.
\]</span>
Nesse caso, temos que <span class="math inline">\(E(Y) = a/(a+b)\)</span> e <span class="math inline">\(Var(Y) = (a+b)/[(a+b)^2(a+b+1)]\)</span>. Podemos usar o <code>R</code> para visualizar alguns exemplos dessa densidade fazendo</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">numero_pontos &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">list_parametros &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), </a>
<a class="sourceLine" id="cb8-3" data-line-number="3">                        <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), </a>
<a class="sourceLine" id="cb8-4" data-line-number="4">                        <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), </a>
<a class="sourceLine" id="cb8-5" data-line-number="5">                        <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>), </a>
<a class="sourceLine" id="cb8-6" data-line-number="6">                        <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">10</span>))</a>
<a class="sourceLine" id="cb8-7" data-line-number="7"></a>
<a class="sourceLine" id="cb8-8" data-line-number="8">densidade_beta &lt;-<span class="st"> </span><span class="kw">lapply</span>(list_parametros, </a>
<a class="sourceLine" id="cb8-9" data-line-number="9">                       <span class="cf">function</span>(x) <span class="kw">dbeta</span>(<span class="dv">0</span><span class="op">:</span>numero_pontos<span class="op">/</span>numero_pontos, </a>
<a class="sourceLine" id="cb8-10" data-line-number="10">                                         x[<span class="dv">1</span>], x[<span class="dv">2</span>])) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="st">  </span><span class="kw">unlist</span>()</a>
<a class="sourceLine" id="cb8-12" data-line-number="12"></a>
<a class="sourceLine" id="cb8-13" data-line-number="13">dados_beta &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span>numero_pontos<span class="op">/</span>numero_pontos, </a>
<a class="sourceLine" id="cb8-14" data-line-number="14">                                 <span class="kw">length</span>(list_parametros)),</a>
<a class="sourceLine" id="cb8-15" data-line-number="15">                              <span class="dt">densidade =</span> densidade_beta, </a>
<a class="sourceLine" id="cb8-16" data-line-number="16">                              <span class="dt">parametros =</span> <span class="kw">rep</span>(<span class="kw">as.character</span>(list_parametros), </a>
<a class="sourceLine" id="cb8-17" data-line-number="17">                                          <span class="dt">each =</span> numero_pontos <span class="op">+</span><span class="st"> </span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb8-18" data-line-number="18"></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"></a>
<a class="sourceLine" id="cb8-20" data-line-number="20"><span class="kw">ggplot</span>(dados_beta, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> densidade, <span class="dt">color =</span> parametros)) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-21" data-line-number="21"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-22" data-line-number="22"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-23" data-line-number="23"><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">name =</span> <span class="st">&quot;(a, b)&quot;</span>)</a></code></pre></div>
<p><img src="notas_livro_files/figure-html/graf14-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Podemos ver que essa distribuição de probabilidade pode apresentar diferentes formas. Em especial, a distribuição uniforme é um caso especial quando <span class="math inline">\(a = 1\)</span> e <span class="math inline">\(b = 1\)</span>.</p>
<p>A distribuição Dirichlet é então uma extensão multivariada para essa distribuição de probabilidade. Se considerarmos um vetor aleatório <span class="math inline">\(\boldsymbol Y\)</span> em que <span class="math inline">\(Y \in [0, 1]^k\)</span> e <span class="math inline">\(\sum_{i=1}^k y_i = 1\)</span>, então dizemos que <span class="math inline">\(\boldsymbol Y\)</span> segue uma distribuição Dirichlet com parâmetro <span class="math inline">\(\boldsymbol \alpha\)</span>, <span class="math inline">\(\alpha \in \mathbb{R}_+^k\)</span>, quando sua função densidade puder ser descrita como
<span class="math display">\[
f(y_1, \cdots, y_k | \boldsymbol \alpha) = \frac{1}{B(\boldsymbol \alpha)} 
\prod_{i=1}^k y_i^{\alpha_i - 1}
\]</span></p>
<p>Essa distribuição de probabilidade é particularmente importante para os métodos de inferência bayesiana que discutiremos na próxima seção. Para fazer o gráfico da densidade, há o problema da dimensionalidade, porém podemos ver alguns exemplos para o caso trivariado nas figuras, conforme variamos os valores de <span class="math inline">\(\boldsymbol \alpha\)</span>.
<img src="notas_livro_files/figure-html/graf15-1.png" width="80%" style="display: block; margin: auto;" /><img src="notas_livro_files/figure-html/graf15-2.png" width="80%" style="display: block; margin: auto;" /><img src="notas_livro_files/figure-html/graf15-3.png" width="80%" style="display: block; margin: auto;" /><img src="notas_livro_files/figure-html/graf15-4.png" width="80%" style="display: block; margin: auto;" /><img src="notas_livro_files/figure-html/graf15-5.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Notem que quando <span class="math inline">\(\alpha_1 = \alpha_2 = \alpha_3\)</span> a densidade se concentra em valores mais centrais do simplex em três dimensões, com exceção do caso em que todos os valores são iguais a 1. Nesse caso, temos um exemplo de uma distribuição uniforme multivariada. Para os outros valores de <span class="math inline">\(\alpha\)</span> a concentração da densidade depende dos valores definidos, mas as densidades apresentam diferentes formas.</p>
</div>
</div>
<div id="metodos-inferenciais" class="section level2">
<h2><span class="header-section-number">1.3</span> Métodos inferenciais</h2>
<p>Na seção anterior, mostramos alguns exemplos das distribuições apresentadas, porém utilizamos valores fixos dos parâmetros para ilustrar suas funções de probabilidade ou função densidade. Na prática, esses parâmetros são desconhecidos e precisamos estimá-los. Nessa seção, apresentaremos brevemente alguns resultados para estimação desses parâmetros, tanto do ponto de vista clássico, utilizando métodos de maximização da verossimilhança, quanto do ponto de vista clássico, apresentando o Teorema de Bayes utilizado para o cálculo.</p>
<div id="metodo-da-maxima-verossimilhanca" class="section level3">
<h3><span class="header-section-number">1.3.1</span> Método da máxima verossimilhança</h3>
<p>Quando consideramos os dados observados e calculamos a probabilidade de observar aquela amostra como uma função do parâmetros, estamos definindo a <strong>função de verossimilhança</strong>. Tome como exemplo, o caso Binomial em que <span class="math inline">\(n = 6\)</span> e observamos 2 <em>sucessos</em>, ou seja, a probabilidade de observamos essa amostra para diferentes valores de <span class="math inline">\(p\)</span> é dada por
<span class="math display">\[
P(Y = 2|p) = {6 \choose 2} p^2 (1-p)^4.
\]</span>
Note que a equação acima está definida para diferentes valores de <span class="math inline">\(p\)</span>. Inclusive podemos colocar essa informação em um gráfico, da seguinte forma:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">verossimilhanca_bin &lt;-<span class="st"> </span><span class="cf">function</span>(p, n, y){</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">  <span class="kw">dbinom</span>(y, <span class="dt">size =</span> n, <span class="dt">prob =</span> p) </a>
<a class="sourceLine" id="cb9-3" data-line-number="3">}</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="kw">curve</span>(<span class="kw">verossimilhanca_bin</span>(x, <span class="dt">n =</span> <span class="dv">6</span>, <span class="dt">y =</span> <span class="dv">2</span>), </a>
<a class="sourceLine" id="cb9-6" data-line-number="6">      <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="notas_livro_files/figure-html/vero_bin-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Nesse caso, para o caso binomial podemos sempre escrever a função de verossimilhança como
<span class="math display">\[
L(p) = {n \choose y} p^y (1-p)^{n-y},
\]</span>
em que <span class="math inline">\(n\)</span> e <span class="math inline">\(y\)</span> são sempre considerados fixados. É possível mostrar que o estimador de máxima verossimilhança (EMV) é dado por
<span class="math display">\[
\hat{p} = \frac{y}{n},
\]</span>
em que <span class="math inline">\(y\)</span> representa o valor de <em>sucessos</em> observados. No exemplo anterior, teríamos <span class="math inline">\(\hat{p} = 2/6 = 1/3\)</span>. Tal informação pode ser vista no gráfico da função de verossimilhança, uma vez que 1/3 é o ponto em que a função de verossimilhança apresenta seu maior valor.</p>
<p>O EMV tem boas propriedades assintóticas, por isso ele é bastante utilizado. Podemos descrever a incerteza sobre os seus valores utilizando o resultado que, se <span class="math inline">\(\hat{\theta}\)</span> é o EMV para o estimando o parâmetro <span class="math inline">\(\theta\)</span>, então podemos dizer em geral que<br />
<span class="math display">\[
\frac{\hat{\theta} - \theta}{I(\theta)} \stackrel{a}{\sim} N(0, 1),
\]</span>
em que <span class="math inline">\(I(\theta)\)</span> é a informação de Fisher. Isso nos mostra que o EMV é assintoticamente não viesado para estimar <span class="math inline">\(\theta\)</span>. No caso binomial, temos que
<span class="math display">\[
\hat{p} \sim N\left(p, \frac{p(1-p)}{n} \right).
\]</span>
Esse resultado pode ser justificado também pelo Teorema Central do Limite, notando que o estimador é uma soma de variáveis aleatórias com distribuição Bernoulli. E essa informação pode ser utilizada para construir intervalos de confiança e testes de hipóteses sobre o parâmetro <span class="math inline">\(p\)</span> de interesse, porém não os discutiremos aqui nessa parte do texto.</p>
<p>Para ilustrar algumas características desses estimadores, podemos discutir alguns resultados tendo em vista valores gerados da distribuição Binomial, com valor <span class="math inline">\(p\)</span> conhecido e fixado. Consideremos <span class="math inline">\(p = 0,30\)</span> e geramos valores de amostra com três tamanhos de amostra diferentes. No primeiro caso geramos 20 valores de <span class="math inline">\(Y \sim Bin(n = 20, 0,3)\)</span>, enquanto no segundo caso geramos 100 valores dessa mesma variável aleatória e no terceiro 200 valores são gerados. Os resultados podem ser observados no gráfico a seguir.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"></a>
<a class="sourceLine" id="cb10-3" data-line-number="3">n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">100</span>, <span class="dv">200</span>)</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">seq_p &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">250</span>)</a>
<a class="sourceLine" id="cb10-5" data-line-number="5"></a>
<a class="sourceLine" id="cb10-6" data-line-number="6">valores_verossimilhanca &lt;-<span class="st"> </span><span class="kw">lapply</span>(n, <span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">  valores_amostrais &lt;-<span class="st"> </span><span class="kw">rbinom</span>(x, <span class="dt">size =</span> <span class="dv">20</span>, <span class="dt">prob =</span> <span class="fl">0.3</span>)</a>
<a class="sourceLine" id="cb10-8" data-line-number="8">  </a>
<a class="sourceLine" id="cb10-9" data-line-number="9">  vero_calc &lt;-<span class="st"> </span><span class="cf">function</span>(p){</a>
<a class="sourceLine" id="cb10-10" data-line-number="10">    <span class="kw">sapply</span>(valores_amostrais, </a>
<a class="sourceLine" id="cb10-11" data-line-number="11">           dbinom, <span class="dt">size =</span> <span class="dv">20</span>, <span class="dt">prob =</span> p, <span class="dt">log =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="st">      </span><span class="kw">sum</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="st">      </span><span class="kw">exp</span>()</a>
<a class="sourceLine" id="cb10-14" data-line-number="14">  }</a>
<a class="sourceLine" id="cb10-15" data-line-number="15">  </a>
<a class="sourceLine" id="cb10-16" data-line-number="16">  <span class="kw">sapply</span>(seq_p, vero_calc)</a>
<a class="sourceLine" id="cb10-17" data-line-number="17">}) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unlist</span>()</a>
<a class="sourceLine" id="cb10-18" data-line-number="18"></a>
<a class="sourceLine" id="cb10-19" data-line-number="19">dados_verossimilhanca &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">valores =</span> valores_verossimilhanca, </a>
<a class="sourceLine" id="cb10-20" data-line-number="20">                                    <span class="dt">p =</span> <span class="kw">rep</span>(seq_p, <span class="dt">times =</span> <span class="kw">length</span>(n)),</a>
<a class="sourceLine" id="cb10-21" data-line-number="21">                                    <span class="dt">tam_amostra =</span> <span class="kw">rep</span>(n, <span class="dt">each =</span> <span class="kw">length</span>(seq_p)))</a>
<a class="sourceLine" id="cb10-22" data-line-number="22"></a>
<a class="sourceLine" id="cb10-23" data-line-number="23"><span class="kw">ggplot</span>(dados_verossimilhanca, <span class="kw">aes</span>(p, valores_verossimilhanca)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-24" data-line-number="24"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-25" data-line-number="25"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-26" data-line-number="26"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>tam_amostra, <span class="dt">scales =</span> <span class="st">&#39;free&#39;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-27" data-line-number="27"><span class="st">  </span><span class="kw">xlim</span>(<span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.35</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Verossimilhança&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Valores de p&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-28" data-line-number="28"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">xintercept =</span> <span class="fl">0.3</span>), <span class="dt">linetype =</span> <span class="dv">2</span>, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">&#39;grey50&#39;</span>)</a></code></pre></div>
<p><img src="notas_livro_files/figure-html/vero_bin2-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Quando aumentamos o tamanho da amostra, aumentamos a informação que temos sobre os possíveis valores de <span class="math inline">\(p\)</span>, que é desconhecido, uma vez que é menor a banda de valores possíveis, tendo em vista a função de verossimilhança. Ou seja, temos menos incerteza sobre quais os possíveis valores de <span class="math inline">\(p\)</span> que podem ter gerado aquela amostra observada. Note inclusive que o estimador para o caso em que 20 valores foram gerados apresenta um pequeno viés, pois a estimativa de máxima verossimilhança se encontra em um valor um pouco maior que 0,30.</p>
</div>
<div id="metodos-bayesianos" class="section level3">
<h3><span class="header-section-number">1.3.2</span> Métodos bayesianos</h3>
<p>Para falar brevemente sobre métodos bayesianos para estimar os parâmetros da distribuição binomial ou da distribuição multinomial, lembremos inicialmente do Teorema de Bayes. Suponha que estamos interessados no estimando <span class="math inline">\(\theta \in \mathbb{R}\)</span> e suponhamos uma distribuição a priori <span class="math inline">\(p(\theta)\)</span> para esse parâmetro. O Teorema de Bayes nos diz que a distribuição a posteriori de <span class="math inline">\(\theta\)</span> pode ser escrita como
<span class="math display">\[
p(\theta | y) = \frac{L(\theta)}{p(y)} p(\theta),
\]</span>
em que <span class="math inline">\(L(\theta)\)</span> é a verossimilhança dos dados e <span class="math inline">\(p(y) = \int_\mathbb{R} p(y|\theta) p(\theta) d(\theta)\)</span> é a distribuição marginal dos dados. Em geral, podemos desconsiderar o denominador, por se tratar somente de uma função normalizador, para que a integral da densidade a posteriori integre 1, pois essa quantidade não depende de <span class="math inline">\(\theta\)</span>. Então, podemos escrever a densidade a posteriori como
<span class="math display">\[
p(\theta | y) \propto L(\theta) p(\theta),
\]</span>
ou seja, a informação a posteriori é o conhecimento que tínhamos a priori, atualizado pela função de verossimilhança. Por esse motivo, que o Teorema de Bayes é conhecido como o procedimento estatístico para atualizarmos sobre nossas crenças sobre valores desconhecidos quando obtemos novas informações.</p>
<p>Na seção anterior, discutimos o método de verossimilhança para obter estimativas sobre <span class="math inline">\(p\)</span> no caso Binomial. Vejamos agora como podemos adicionar a informação a priori para obtermos uma distribuição a posteriori para <span class="math inline">\(p\)</span>.</p>
<p>Podemos considerar que a distribuição a priori deve ser a medida de conhecimento que temos sobre o parâmetros antes de observarmos nossos dados. Uma possível abordagem é considerar todos os valores equiprováveis a priori. Como o espaço paramétrico de <span class="math inline">\(p\)</span> é o intervalo [0, 1], então poderíamos considerar a distribuição uniforme nesse mesmo intervalo. Nesse caso, a distribuição a posteriori vai ter a mesma forma (ou distribuição) da verossimilhança, pois a distribuição dá pesos iguais para todos os valores de <span class="math inline">\(p\)</span>. Note que a distribuição Uniforme no intervalo (0, 1) para variáveis contínuas é um caso especial da distribuição Beta quando os seus respectivos parâmetros são ambos iguais a 1.</p>
<p>No entanto, podemos discutir a distribuição de probabilidade a posteriori de <span class="math inline">\(p\)</span> para diferentes valores de <span class="math inline">\(a\)</span> e <span class="math inline">\(b\)</span>, da função densidade de uma variável aleatória com distribuição Beta. Mudando um pouco as definição para facilitar a leitura, se considerarmos somente os termos que dependem de <span class="math inline">\(p\)</span>, podemos reescrever o seguinte para a distribuição a posteriori</p>
<p><span class="math display">\[
\begin{aligned} 
\pi(p| y) &amp;\propto L(p) \pi(p) \\ 
&amp;\propto p^{y} (1-p)^{n-y} p^{a - 1}(1-p)^{b-1} \\ 
&amp;= p^{y + a - 1}(1-p)^{n - y + b - 1}.
\end{aligned}
\]</span></p>
<p>O resultado anterior indica que a distribuição a posteriori de <span class="math inline">\(p\)</span>, quando consideramos uma distribuição a priori, <span class="math inline">\(p \sim \mbox{Beta}(a, b)\)</span>, também tem distribuição Beta com parâmetros <span class="math inline">\(y + a\)</span> e <span class="math inline">\(n - y + b\)</span>, quando consideramos para a verossimilhança <span class="math inline">\(Y|p \sim Bin(n, p)\)</span>. Considerando novamente o cenário em que obtivemos 2 sucessos em 6 eventos independentes com distribuição Bernoulli, com probabilidade <span class="math inline">\(p\)</span>,podemos comparar a distribuição a posteriori para diferentes valores de <span class="math inline">\(a\)</span> e <span class="math inline">\(b\)</span>. No gráfico a seguir, a linha preta representa a função de verossimilhança, enquanto que as linhas coloridas representam as quantidades consideradas pela atualização bayesiana: a linha pontilhada colorida representa a informação a priori, enquanto que a respectiva linha cheia colorida representa a distribuição a priori.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)), <span class="kw">aes</span>(x)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> verossimilhanca_bin, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">n =</span> <span class="dv">6</span>, <span class="dt">y =</span> <span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dbeta, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">shape1 =</span> <span class="dv">3</span>, <span class="dt">shape2 =</span> <span class="dv">5</span>), </a>
<a class="sourceLine" id="cb11-5" data-line-number="5">                <span class="dt">color =</span> <span class="st">&#39;red&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dbeta, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">shape1 =</span> <span class="dv">1</span>, <span class="dt">shape2 =</span> <span class="dv">1</span>), </a>
<a class="sourceLine" id="cb11-7" data-line-number="7">                <span class="dt">color =</span> <span class="st">&#39;red&#39;</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dbeta, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">shape1 =</span> <span class="dv">4</span>, <span class="dt">shape2 =</span> <span class="dv">6</span>), </a>
<a class="sourceLine" id="cb11-9" data-line-number="9">                <span class="dt">color =</span> <span class="st">&#39;blue&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dbeta, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">shape1 =</span> <span class="dv">2</span>, <span class="dt">shape2 =</span> <span class="dv">2</span>), </a>
<a class="sourceLine" id="cb11-11" data-line-number="11">                <span class="dt">color =</span> <span class="st">&#39;blue&#39;</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dbeta, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">shape1 =</span> <span class="dv">5</span>, <span class="dt">shape2 =</span> <span class="dv">6</span>), </a>
<a class="sourceLine" id="cb11-13" data-line-number="13">                <span class="dt">color =</span> <span class="st">&#39;green&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dbeta, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">shape1 =</span> <span class="dv">3</span>, <span class="dt">shape2 =</span> <span class="dv">2</span>), </a>
<a class="sourceLine" id="cb11-15" data-line-number="15">                <span class="dt">color =</span> <span class="st">&#39;green&#39;</span>, <span class="dt">linetype =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="notas_livro_files/figure-html/posteriori_exemplo-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Note que a depender da distribuição a priori, a distribuição a posteriori apresenta diferentes formas e também diferentes estimativas, a depender da função de perda de interesse. Compare agora com a situação supondo que o experimento independente Bernoulli foi repetido mais vezes, i.e., <span class="math inline">\(n = 60\)</span> e <span class="math inline">\(y = 20\)</span>, porém observando ainda a mesma proporção de <em>sucessos</em>.</p>
<p><img src="notas_livro_files/figure-html/posteriori_exemplo2-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Note que conforme o número de repetições do experimento Bernoulli aumenta, a contribuição da distribuição a priori é menos relevante. Nesse segundo exemplo, as distribuições a posteriori tem forma muito próximas, o que indica que a inferência sobre o parâmetro <span class="math inline">\(p\)</span> vai ter um peso muito maior da verossimilhança do que da distribuição a priori.</p>
<p>Quando consideramos o caso multinomial, uma vez que os parâmetros da distribuição são multivariados, temos que considerar uma outra distribuição a priori, que não a distribuição beta. Nesse caso, podemos utilizar a distribuição Dirichlet, que foi apresentada na seção anterior.</p>
<p>No caso binomial, vimos que as distribuições a priori e posteriori coincidiam: ambas têm distribuição beta. Quando isso, acontece dizemos que a distribuição é a família conjugada de distribuições para o modelo binomial. Podemos mostrar que no modelo multinomial, a distribuição Dirichlet é a respectiva família conjugada. A demonstração desse resultado fica como exercício, assim como ilustrações para diferentes valores de parâmetro.</p>
</div>
</div>
<div id="exercicios" class="section level2">
<h2><span class="header-section-number">1.4</span> Exercícios</h2>
<ol style="list-style-type: decimal">
<li>Considere um exame com 50 questões de múltipla escolha, com 5 alternativas em cada questão, em que apenas umas das opções está correta. Considere que uma pessoa responde de forma aleatória cada uma das questões e que suas respostas são independentes entre si.
<ol style="list-style-type: lower-alpha">
<li>Defina variável aleatória <span class="math inline">\(X\)</span> número de respostas certas ao final do exame. Descreva a distribuição de probabilidade de X.</li>
<li>Calcule a probabilidade do número de acertos ser maior que a metade da prova. Se necessário, utilze alguma aproximação para fazer esse cálculo.</li>
</ol></li>
<li>Considere a variável aleatória ao final do curso de Estatística, em que os seus possíveis são “Aprovado”, “Reprovado por falta”, “Reprovado por nota”. Sejam <span class="math inline">\((N_1, N_2, N_3)\)</span> as respectivas quantidades aleatórias em uma determinada turma. Suponha que esses valores ocorrem com probabilidade <span class="math inline">\((\pi_1, \pi_2, \pi_3)\)</span>. Considere uma turma com 3 pessoas com resultados independentes, em que as frequências observadas são <span class="math inline">\((n_1, n_2, n_3)\)</span>.
<ol style="list-style-type: lower-alpha">
<li>Mostre que é possível obter <span class="math inline">\(n_3\)</span> a partir de <span class="math inline">\(n_1\)</span> e <span class="math inline">\(n_2\)</span>. Logo, discuta que a distribuição de probabilidade do vetor aleatório <span class="math inline">\((N_1, N_2, N_3)\)</span> é na verdade bidimensional.</li>
<li>Apresente o conjunto de todas as possibilidades das frequências observadas <span class="math inline">\((n_1, n_2, n_3)\)</span> quando <span class="math inline">\(n = 3\)</span>.</li>
<li>Suponha que <span class="math inline">\((\pi_1, \pi_2, \pi_3) = (0.70, 0.10, 0.20)\)</span>. Encontre a probabilidade utilizando a distribuição multinomial que <span class="math inline">\((N_1, N_2, N_3) = (2, 1, 0)\)</span>.</li>
</ol></li>
<li><p>Escreva uma função no R para calcular a função de verossimilhança para o modelo multinomial trivariado. Gere 20 valores aleatórios dessa distribuição de probabilidade, fixando os valores dos parâmetros. Mostre que a função de verossimilhança recupera os valores dos parâmetros de maneira satisfatória para esses valores gerados. Compare com o caso em que 200 valores são gerados. O que esse resultado nos mostra?</p></li>
<li><p>Mostre que a distribuição Dirichlet faz parte da família conjugada para o modelo multinomial, i.e., mostre que a distribuição a posteriori dos parâmetros do modelo multinomial têm uma distribuição Dirichlet quando consideramos essa mesma distribuição para a distribuição a priori.</p></li>
<li><p>Considere novamente a variável aleatória do exercício 2. Agora tome que os valores observados são iguais a <span class="math inline">\((n_1, n_2, n_3) = (10, 3, 2)\)</span>. Considere uma distribuição a priori Dirichlet com parâmetros <span class="math inline">\(\boldsymbol \alpha = (1, 1, 1)\)</span> e também <span class="math inline">\(\boldsymbol \alpha = (3, 2, 1)\)</span>. Compare os resultados da distribuição a posteriori para os dois casos. Verifique se existem diferenças se considerássemos os valores observados como <span class="math inline">\((n_1, n_2, n_3) = (50, 15, 10)\)</span>.</p></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>

<a href="tabelas-de-contingencia.html" class="navigation navigation-next navigation-unique" aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["notas_livro.pdf", "notas_livro.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
